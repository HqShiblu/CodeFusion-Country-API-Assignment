# CodeFusion Country API Assignment
Read the specifications [here](https://workdrive.zohopublic.eu/file/j2a2g0216a20eacd84923aa639dae1710f712).

## Requirements
- Python 3.12 or above.
- PostgreSQL 14 or above.

## Getting started
First, Create a database in PostgreSQL.

Clone the repository from [GitHub](https://github.com/HqShiblu/CodeFusion-Country-API-Assignment).
Open the .sample_env file.
Enter the SECRET_KEY value and database credentials and then save it as **.env** file.

Create a virtual environment.
Use **python** in **Windows** and **python3** in **Linux**.
```
python -m venv country_api_venv
```

Move to Scripts (for **Windows**) or bin (for **Linux**) folder of the environment.
Then activate the environment.

Then, move to the location of the project where **manage.py** file is.
Install the required packages with 
```
pip install -r requirements.txt
```
Use **pip** in **Windows** and **pip3** in **Linux**.


Now, run
```
python manage.py migrate
```
to migrate the models to the database.



### Phase 1
Run
```
python manage.py seed_data
```
to fetch and save the country data to the database.


### Phase 2
#### Authentication
The APIs can be accessed only by authenticated users.
So, create a user first from the command line
```
python manage.py createsuperuser
```
Provide username and password.

Now run the project with
```
python manage.py runserver
```

Full Documentation of **Phase 2** is available through Swagger.

`GET /api/schema/swagger-ui/`

<details>
	<summary>Click here to view full details</summary>

______________

Hit the URL

`POST /api/login/`

with 

```
{
    "username":"your_username",
    "password":"your_password"
}
```
Provide your username and password in the parameter

If username and password are correct it will return something like this
```
{
	"message": "Success",
	"status": 200,
	"token": "Token generated by the app................."
}
```
Copy the token and send it as a **Bearer** token in **Authorization Header** in rest of the URLs in **Phase 2** .

### 1. List all countries

`GET /api/get-all-countries/`

It will return a list of all the countries in the database.

### 2. Retreive details of a specific country

`GET /api/get-specific-country/{id}/`

Insert the id of the country in the **id** variable.

### 3. Create a new country entry

`POST /api/save-country-data/`

Sample Input
```
{
    "cca2": "TSTCN",
    "common_name": "Test Country",
    "official_name": "Republic of Test Country",
    "region": "Asia",
    "subregion": "Asia",
    "capital": "Test",
    "latitude": -20.0,
    "longitude": 20.0,
    "area": 14500,
    "population": 12345,
    "flag": "https://flagcdn.com/w320/bw.png",
    "timezones": [
        "UTC+05:00"
    ]
}
```

Sample Output
```
{
    "message":"Success",
    "status":200
}
```

### 4. Update an existing country's details

`POST /api/update-country-data/{id}/`

Insert the id of the country in the **id** variable.

Sample Input
```
{
    "cca2": "TSTCN",
    "common_name": "Test Country",
    "official_name": "Republic of Test Country",
    "region": "Asia",
    "subregion": "Asia",
    "capital": "Test",
    "latitude": -20.0,
    "longitude": 20.0,
    "area": 14500,
    "population": 12345,
    "flag": "https://flagcdn.com/w320/bw.png",
    "timezones": [
        "UTC+05:00"
    ]
}
```

Sample Output
```
{
    "message":"Success",
    "status":200
}
```

### 5. Delete an existing country

`DELETE /api/delete-specific-country/{id}/`

Insert the id of the country in the **id** variable.

	
</details>

